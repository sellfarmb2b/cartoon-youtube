# 6700자 대본 처리 시간 예상

## 기본 가정

- **대본 길이**: 6,700자 (공백 포함)
- **평균 문장 길이**: 약 70자 (한국어 기준)
- **예상 문장 수**: 약 **95-100개 문장**
- **청크 분할**: SCRIPT_CHUNK_MAX_SENTENCES = 80
  - 약 **2개 청크**로 분할됨

## 단계별 예상 시간

### 1단계: 프롬프트 생성 (OpenAI API)
- **문장 수**: 100개
- **배치 크기**: 12개 (OPENAI_PROMPT_BATCH_SIZE)
- **병렬 워커**: 2개 (OPENAI_PROMPT_WORKERS)
- **배치 수**: 약 9개 배치
- **각 배치 시간**: 5-10초 (재시도 포함)
- **총 예상 시간**: **45-90초 (약 1-1.5분)**

### 2단계: 이미지 생성 (Replicate API)
- **이미지 수**: 100개
- **병렬 워커**: 4개 (MAX_SCENE_WORKERS)
- **각 이미지 생성 시간**: 
  - 애니메이션 모드: 10-20초
  - 실사화 모드: 15-30초
- **총 예상 시간**: 
  - 애니메이션: **250-500초 (약 4-8분)**
  - 실사화: **375-750초 (약 6-12분)**

### 3단계: TTS 생성 (ElevenLabs API)
- **오디오 수**: 100개
- **병렬 처리**: ThreadPoolExecutor 사용
- **각 오디오 생성 시간**: 3-5초 (문장 길이에 따라 다름)
- **총 예상 시간**: **300-500초 (약 5-8분)**

### 4단계: 타임스탬프 계산
- **처리 방식**: 로컬 파일 읽기
- **예상 시간**: **1-2초** (매우 빠름)

### 5단계: 비디오 합성 (FFmpeg)
- **씬 수**: 100개
- **청크 수**: 2개
- **각 청크 비디오 생성**: 
  - 50개 씬당 약 60-120초
- **최종 비디오 합치기**: 10-20초
- **총 예상 시간**: **130-260초 (약 2-4분)**

## 전체 예상 시간

### 애니메이션 모드
- **최소 시간**: 45 + 250 + 300 + 2 + 130 = **727초 (약 12분)**
- **최대 시간**: 90 + 500 + 500 + 2 + 260 = **1,352초 (약 22분)**
- **평균 예상 시간**: **약 15-17분**

### 실사화 모드
- **최소 시간**: 45 + 375 + 300 + 2 + 130 = **852초 (약 14분)**
- **최대 시간**: 90 + 750 + 500 + 2 + 260 = **1,602초 (약 27분)**
- **평균 예상 시간**: **약 18-20분**

## 시간 단축 방법

### 현재 적용된 최적화
1. ✅ **병렬 처리**: 이미지/TTS 생성 병렬화
2. ✅ **청크 분할**: 긴 대본을 5분 단위로 분할
3. ✅ **배치 처리**: OpenAI 프롬프트 생성 배치화

### 추가 최적화 가능 사항
1. **병렬 워커 증가**
   - MAX_SCENE_WORKERS: 4 → 8 (이미지 생성 속도 2배)
   - 단, API rate limit 주의 필요

2. **더 빠른 이미지 모델 사용**
   - 현재: leonardoai/lucid-origin (10-20초)
   - 대안: 더 빠른 모델 사용 시 5-10초로 단축 가능

3. **TTS 배치 처리**
   - 현재: 개별 API 호출
   - 개선: 여러 문장을 한 번에 처리 (API 지원 시)

## 실제 시간 변동 요인

1. **API 응답 속도**
   - 네트워크 상태
   - API 서버 부하
   - 재시도 횟수

2. **이미지 생성 모델**
   - 모델별 생성 시간 차이
   - 큐 대기 시간

3. **FFmpeg 렌더링**
   - CPU 성능
   - 디스크 I/O 속도

4. **청크 분할**
   - 청크가 많을수록 최종 합치기 시간 증가

## 결론

**6700자 대본 기준 예상 시간:**
- **애니메이션 모드**: **약 15-17분**
- **실사화 모드**: **약 18-20분**

실제 시간은 네트워크 상태, API 서버 부하, 시스템 성능에 따라 ±30% 정도 변동될 수 있습니다.

